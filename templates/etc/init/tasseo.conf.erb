description "start and stop tasseo"
author "Gareth Rushgrove"

start on virtual-filesystems
stop on runlevel [06]

respawn
respawn limit 5 30

env GRAPHITE_URL=<%= scope.lookupvar('tasseo::graphite_url') %>
env PORT=<%= scope.lookupvar('tasseo::port') %>

<% if scope.lookupvar('tasseo::graphite_auth') %>env GRAPHITE_AUTH=<%= scope.lookupvar('tasseo::graphite_auth') %><% end %>

chdir /opt/tasseo
setuid www-data
setgid www-data

console log
script
exec bundle exec rackup -p $PORT
end script
